<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="ProyectoFinal.Vista.ConsumoDiarioView"
             x:Name="Pagina"
             Title="ConsumoDiarioView">
    <ScrollView>
        <StackLayout Padding="20" Spacing="15">

            <Label Text="Selecciona un alimento:" FontSize="18" />
            <Picker ItemsSource="{Binding Alimentos}" 
                    ItemDisplayBinding="{Binding Nombre}"
                    SelectedItem="{Binding AlimentoSeleccionado}" />

            <Label Text="Cantidad (gramos):" FontSize="18" />
            <Entry Keyboard="Numeric" Text="{Binding CantidadGramos}" />

            <Button Text="Agregar al consumo"
                    Command="{Binding AgregarAlimentoCommand}" />

            <Label Text="Alimentos consumidos hoy:" FontAttributes="Bold" FontSize="18" />

            <CollectionView ItemsSource="{Binding AlimentosConsumidos}">
                <CollectionView.ItemTemplate>
                    <DataTemplate>
                        <StackLayout Padding="10" Orientation="Vertical">
                            <Label Text="{Binding Nombre}" FontSize="16" />
                            <Label Text="{Binding CantidadGramos}" FontSize="14" />
                            <Label Text="{Binding Calorias, StringFormat='Cal: {0} kcal'}" FontSize="12" />
                            <Label Text="{Binding Proteinas, StringFormat='Prot: {0} g'}" FontSize="12" />
                            <Label Text="{Binding Carbohidratos, StringFormat='Carb: {0} g'}" FontSize="12" />
                            <Label Text="{Binding Grasas, StringFormat='Gras: {0} g'}" FontSize="12" />

                            <!-- Botón para eliminar -->
                            <Button Text="Eliminar"
                                    Command="{Binding BindingContext.EliminarAlimentoCommand, Source={x:Reference Pagina}}"
                                    CommandParameter="{Binding}"
                                    BackgroundColor="Red"
                                    TextColor="White"
                                    CornerRadius="5"
                                    Padding="5"
                                    Margin="0,5,0,0"/>
                        </StackLayout>
                    </DataTemplate>
                </CollectionView.ItemTemplate>
            </CollectionView>

            <!-- Totales al final -->
            <Label FontSize="16" FontAttributes="Bold" Text="Totales del día:" />

            <Label Text="{Binding TotalCalorias, StringFormat='Calorías: {0} kcal'}" />
            <Label Text="{Binding TotalProteinas, StringFormat='Proteínas: {0} g'}" />
            <Label Text="{Binding TotalCarbohidratos, StringFormat='Carbohidratos: {0} g'}" />
            <Label Text="{Binding TotalGrasas, StringFormat='Grasas: {0} g'}" />

        </StackLayout>
    </ScrollView>
</ContentPage>
